<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>ESP32 Rover Control</title>
<style>
button{width:60px;height:60px;font-size:20px;margin:5px;}
#ultra{margin-top:20px;}
</style>
</head>
<body>
<h2>ESP32 Rover Control</h2>
<div>
  <button onmousedown="send('w',1)" onmouseup="send('w',0)" ontouchstart="send('w',1)" ontouchend="send('w',0)">W</button><br>
  <button onmousedown="send('a',1)" onmouseup="send('a',0)" ontouchstart="send('a',1)" ontouchend="send('a',0)">A</button>
  <button onmousedown="send('s',1)" onmouseup="send('s',0)" ontouchstart="send('s',1)" ontouchend="send('s',0)">S</button>
  <button onmousedown="send('d',1)" onmouseup="send('d',0)" ontouchstart="send('d',1)" ontouchend="send('d',0)">D</button><br>
  <button onclick="send('x',1)">STOP</button>
  <button onclick="send('m',1)">AUTO/MANUAL</button>
</div>
<div id="ultra">Ultrasonic: -- cm</div>

<script>
function send(key,state){
  fetch(`/press?key=${key}&state=${state}`);
}

// Poll ultrasonic sensor every 2s
setInterval(()=>{
  fetch('/ultra').then(r=>r.text()).then(t=>{
    document.getElementById('ultra').innerHTML = 'Ultrasonic: '+t+' cm';
  });
},2000);
</script>
</body>
</html>
